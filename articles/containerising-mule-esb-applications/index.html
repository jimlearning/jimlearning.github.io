<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"/><meta name="og:site_name" content="JimLearningBlog"/><link rel="canonical" href="https://jimlearning.github.io/articles/containerising-mule-esb-applications"/><meta name="twitter:url" content="https://jimlearning.github.io/articles/containerising-mule-esb-applications"/><meta name="og:url" content="https://jimlearning.github.io/articles/containerising-mule-esb-applications"/><title>Containerising a Mule 4 application | JimLearningBlog</title><meta name="twitter:title" content="Containerising a Mule 4 application | JimLearningBlog"/><meta name="og:title" content="Containerising a Mule 4 application | JimLearningBlog"/><meta name="description" content="In this post we will walk through how you can run a simple Mule 4 application inside of a Docker container."/><meta name="twitter:description" content="In this post we will walk through how you can run a simple Mule 4 application inside of a Docker container."/><meta name="og:description" content="In this post we will walk through how you can run a simple Mule 4 application inside of a Docker container."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to JimLearningBlog"/></head><head><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karla:400,400i,700,700i"/><link rel="stylesheet" href="/PersonalTheme/fontawesome/all.min.css"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">JimLearningBlog</a><p>A description of JimLearningBlog</p><nav><ul><li><a href="/posts"><span></span>Posts</a></li><li><a class="selected" href="/articles"><span class="far fa-newspaper"></span>Articles</a></li><li><a href="/tips"><span class="far fa-star"></span>Tips</a></li><li><a href="/apps"><span></span>Apps</a></li><li><a href="/tags"><span class="fas fa-hashtag"></span>Tags</a></li><li><a href="/about"><span class="far fa-user"></span>About Me</a></li></ul></nav></div></header><div class="wrapper"><article class="animated fadeIn"><span class="date">Published on 2019å¹´05æœˆ28æ—¥.</span><span class="read-time">ðŸ•‘ 3 minutes read.</span><h1>Containerising a Mule 4 application</h1><ul class="tag-list"><li class="tag variant-0"><a href="/tags/articles">Articles</a></li><li class="tag variant-3"><a href="/tags/docker">Docker</a></li><li class="tag variant-11"><a href="/tags/mule-esb">Mule ESB</a></li></ul><p>In this post we will walk through how you can run a simple Mule 4 application inside of a Docker container.</p><div class="content"><h2>Prerequisites</h2><p>To keep things brief, we will assume you already have JDK 8, Maven 3 and Docker installed and setup correctly. Your docker host needs to have at least 1GB of available RAM to run Mule ESB Server Runtime. You can refer to the <a href="https://docs.mulesoft.com/mule-runtime/4.2/hardware-and-software-requirements">Mule ESB hardware requirements</a> documentation for additional information.</p><h2>Hello world Mule 4 application</h2><img src="/images/posts/mulesoft-logo.svg" alt="MuleSoft logo"/><p>I have created a simple Hello World application inside Mule 4 which can be used for this walkthrough. It has a single HTTP listener flow that listens on <code>http://localhost:8081/api/hello-world</code> and can be found on <a href="https://github.com/Mike-Gough/mule-4-hello-world">GitHub</a>. The GitHub repository contains an example for both the community edition and enterprise edition of Mule. You can download and use either example, or if you prefer, your own application. However, if you choose to use the enterprise edition inside Docker you may need to install a licence file.</p><h2>Building the application</h2><p>To build the application, open your Command Line Interface (CLI) of choice, navigate to the application directory and run:</p><pre><code>mvn clean package
</code></pre><p>This will cause Maven to create a <code>target</code> folder and package the application into a jar file inside of it. We will be using this jar file inside of our Docker image.</p><h2>Creating a Docker image for the Mule application</h2><p>To begin with, we will need to create a new file called <code>Dockerfile</code> in our working directory. A Dockerfile has a file format that contains instructions and arguments, which define the contents and startup behaviour of the Docker container. To containerise the example Mule application, our Dockerfile will need to have the following contents for a community edition application:</p><pre><code># <span class="type">The</span> first instruction <span class="keyword">in</span> a <span class="type">Dockerfile</span> must be <span class="type">FROM</span>, which selects a base image. <span class="type">We</span> are using the image <span class="type">I</span> published from a previous post about containerising the <span class="type">Mule ESB</span>. <span class="type">Change</span> this line to your own repository <span class="keyword">if</span> you have created your own image.
<span class="type">FROM</span> mikeyryan/mule:<span class="number">4.2.0</span>-ce

# <span class="type">Copy</span> the jar that was generated during the package maven phase and place it <span class="keyword">in</span> the apps folder
<span class="type">COPY</span> ./target/mule-<span class="number">4</span>-hello-world*.jar /opt/mule/apps/

# <span class="type">Start</span> the mule runtime
<span class="type">CMD</span> [<span class="string">"/opt/mule/bin/mule"</span>]

# <span class="type">HTTP</span> listener <span class="keyword">default</span> port
<span class="type">EXPOSE</span> <span class="number">8081</span>
</code></pre><p>If you are containerising an enterprise edition application, you will need to replace <code>-ce</code> with <code>-ee</code> in the line that begins with FROM. For applications other than the provided example from GitHub, you will need to modify the name of the JAR inside the COPY command to match the name of your project.</p><p>The above Dockerfile builds an image based on a pre-existing Mule ESB image and adds the application to it. Run it now by executing the following command:</p><pre><code>docker build \
  --tag mule-<span class="number">4</span>-hello-world .
</code></pre><p>This command creates a Docker image called <code>mule-4-hello-world</code> which we can use to run our application.</p><h2>Running the application using Docker</h2><p>To start a Docker container based on this image, execute the following command:</p><pre><code>docker run --rm -it \
  --name mule-<span class="number">4</span>-hello-world \
  -p <span class="number">8081</span>:<span class="number">8081</span> \
  mule-<span class="number">4</span>-hello-world
</code></pre><p>This will start a Docker container which will run in the foreground. The Docker image exposes port 8081 and binds it to the same port on localhost.</p><p>Once the application is running, it can be accessed by navigating to <a href="http://localhost:8081/api/hello-world">http://localhost:8081/api/hello-world</a> in your browser. When accessed, your browser should show:</p><pre><code><span class="type">Hello</span> from <span class="type">Mule</span> <span class="number">4.2.0</span>
</code></pre><h2>Summary</h2><p>We have previously walked through how to containerise the Mule ESB and now we've demonstrated how easy it is to run Mule applications inside Docker containers. For those who prefer not to venture down the path of containerising the Mule ESB themselves, they can still containerise a Mule application using the mikeyryan/mule image to easily get up and running.</p><h2>References</h2><ul><li><a href="https://mike.gough.me/posts/docker/mule/esb/enterprise-edition "Containerising Mule Enterprise Service Bus (ESB) Enterprise Edition"">Containerising Mule Enterprise Service Bus (ESB) Enterprise Edition</a></li><li><a href="https://mike.gough.me/posts/docker/mule/esb/community-edition "Containerising Mule Enterprise Service Bus (ESB) Community Edition"">Containerising Mule Enterprise Service Bus (ESB) Community Edition</a></li><li><a href="https://github.com/Mike-Gough/mule-4-hello-world "Mike-Gough/mule-4-hello-world"">Mule 4 - Example hello world application repository</a></li></ul><p class="footer">Thanks for reading! ðŸš€</p></div><ul class="share grid compact"><li><a class="twitter" href="https://twitter.com/intent/tweet?via=MikeRyanGough&text=Containerising%20a%20Mule%204%20application&url=https://jimlearning.github.ioarticles/containerising-mule-esb-applications">Share on Twitter</a></li><li><a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://jimlearning.github.ioarticles/containerising-mule-esb-applications">Share on Facebook</a></li><li><a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&&titleContainerising%20a%20Mule%204%20application=&summary=&source=&url=https://jimlearning.github.ioarticles/containerising-mule-esb-applications">Share on LinkedIn</a></li></ul></article></div><footer class="animated fadeIn"><p>Mike Gough Â© 2020.</p><p>Powered by <a href="https://github.com/johnsundell/publish">Publish</a> and hosted on <a href="https://github.com/Mike-Gough/Mike-Gough.github.io">GitHub Pages</a>. 100% JavaScript-free.</p><p>Notice a broken link or other issue? <a href="https://github.com/Mike-Gough/Mike-Gough.github.io/issues">Open an issue!</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></body></html>