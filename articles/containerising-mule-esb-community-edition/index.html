<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"/><meta name="og:site_name" content="JimLearningBlog"/><link rel="canonical" href="https://jimlearning.github.io/articles/containerising-mule-esb-community-edition"/><meta name="twitter:url" content="https://jimlearning.github.io/articles/containerising-mule-esb-community-edition"/><meta name="og:url" content="https://jimlearning.github.io/articles/containerising-mule-esb-community-edition"/><title>Containerising Mule Enterprise Service Bus (ESB) Community Edition | JimLearningBlog</title><meta name="twitter:title" content="Containerising Mule Enterprise Service Bus (ESB) Community Edition | JimLearningBlog"/><meta name="og:title" content="Containerising Mule Enterprise Service Bus (ESB) Community Edition | JimLearningBlog"/><meta name="description" content="In this post we will assume that you have Docker and would like to create an image that contains the Community Edition of the Mule ESB."/><meta name="twitter:description" content="In this post we will assume that you have Docker and would like to create an image that contains the Community Edition of the Mule ESB."/><meta name="og:description" content="In this post we will assume that you have Docker and would like to create an image that contains the Community Edition of the Mule ESB."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to JimLearningBlog"/></head><head><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karla:400,400i,700,700i"/><link rel="stylesheet" href="/PersonalTheme/fontawesome/all.min.css"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">JimLearningBlog</a><p>A description of JimLearningBlog</p><nav><ul><li><a class="selected" href="/articles"><span class="far fa-newspaper"></span>Articles</a></li><li><a href="/tips"><span class="far fa-star"></span>Tips</a></li><li><a href="/apps"><span></span>Apps</a></li><li><a href="/tags"><span class="fas fa-hashtag"></span>Tags</a></li><li><a href="/about"><span class="far fa-user"></span>About Me</a></li></ul></nav></div></header><div class="wrapper"><article class="animated fadeIn"><span class="date">Published on 2019å¹´05æœˆ26æ—¥.</span><span class="read-time">ðŸ•‘ 3 minutes read.</span><h1>Containerising Mule Enterprise Service Bus (ESB) Community Edition</h1><ul class="tag-list"><li class="tag variant-0"><a href="/tags/articles">Articles</a></li><li class="tag variant-3"><a href="/tags/docker">Docker</a></li><li class="tag variant-11"><a href="/tags/mule-esb">Mule ESB</a></li></ul><p>In this post we will assume that you have Docker and would like to create an image that contains the Community Edition of the Mule ESB.</p><div class="content"><p>If you're looking for a Mule Docker image you can use without making your own, then you can check out <a href="https://hub.docker.com/r/mikeyryan/mule">mikeyryan/mule</a> on Docker Hub.</p><h2>Why Containerise the Mule ESB?</h2><img src="/images/posts/mulesoft-logo.svg" alt="MuleSoft logo"/><p>The Mule ESB will run perfectly fine anywhere that you can install Java. However, you may find yourself in need of a solution that's more scalable than installing it on a standalone machine. A typical scenario for using the Mule ESB is to install it on a standalone server and then deploy all of your applications to it. This comes with a few disadvantages, primarily that a single unhealthy app can impact others in the same Mule ESB. One method of addressing this is to run multiple versions of the Mule ESB on the server, which is where Docker comes in.</p><p>With Docker we can easily deploy containers with the Mule ESB and a single application that will run in an independent isolated environment. This can also be useful for portability, as Docker will help us ensure that the application will run the same locally as it would when it's deployed to a server or the cloud.</p><h2>Creating a Docker image</h2><img src="/images/posts/docker-logo.svg" alt="Docker logo"/><p>To begin with, we will need to create file called <code>Dockerfile</code> in our working directory. A Dockerfile has a file format that contains instructions and arguments, which define the contents and startup behaviour of the Docker container. To run the Mule ESB, our Dockerfile will need to contain the following:</p><pre><code class="language-dockerfile"># The first instruction in a Dockerfile must be FROM, which selects a base image. Since it's recommended to use official Docker images, we will use the official image for openjdk.
FROM openjdk:8-jdk

LABEL maintainer="https://mike.gough.me"

# Define environment variables as arguments that can be passed in when building this image.
ARG MULE_VERSION=4.2.0
ARG TZ=Australia/Sydney

ENV MULE_HOME=/opt/mule
ENV MULE_DOWNLOAD_URL https://repository-master.mulesoft.org/nexus/content/repositories/releases/org/mule/distributions/mule-standalone/${MULE_VERSION}/mule-standalone-${MULE_VERSION}.tar.gz

# Set the timezone
RUN echo ${TZ} &gt; /etc/timezone

# Set the working directory
WORKDIR ${MULE_HOME}

RUN mkdir -p /opt &amp;&amp; \
    cd /opt &amp;&amp; \
    wget "$MULE_DOWNLOAD_URL" -O mule-standalone-${MULE_VERSION}.tar.gz

# Unpack Mule ESB
RUN tar xvzf /opt/mule-standalone-${MULE_VERSION}.tar.gz -C /opt &amp;&amp; \
  rm -f /opt/mule-standalone-${MULE_VERSION}.tar.gz

RUN cd /opt &amp;&amp; \
  rm -rf mule &amp;&amp; \
  ln -s mule-standalone-${MULE_VERSION} mule

# Set the mount locations
VOLUME ["${MULE_HOME}/logs", "${MULE_HOME}/conf", "${MULE_HOME}/apps", "${MULE_HOME}/domains", "${MULE_HOME}/patches", "${MULE_HOME}/.mule"]

# Run this command on container start
CMD [ "${MULE_HOME}/bin/mule"]

# HTTP listener default port, remote debugger, JMX, MMC agent, AMC agent
EXPOSE 8081 5000 1098 7777 9997
</code></pre><p>The above Docker file will create an image based on the official openjdk Docker image. It downloads and installs a specific version of the Mule ESB which can be passed as an optional argument when running the build process. To create the Docker image with version 4.2.0 of the Mule ESB, run the following command:</p><pre><code class="language-bash">docker build \
  --build-arg MULE_VERSION=4.2.0 \
  -t mule:ce-4-2-0 .
</code></pre><p>Thats it! In a future post we will look at how we can use this image as the base for another image which contains a Mule application.</p><h2>References</h2><ul><li><a href="https://hub.docker.com/r/mikeyryan/mule "mikeyryan/mule"">Docker Hub - Mule docker images</a></li><li><a href="https://docs.mulesoft.com/mule-runtime/4.2/mule-standalone "Mule Installation"">Mule Installation</a></li><li><a href="https://developer.mulesoft.com/download-mule-esb-runtime "Mule Kernel"">Mule Kernel</a></li></ul><p class="footer">Thanks for reading! ðŸš€</p></div><ul class="share grid compact"><li><a class="twitter" href="https://twitter.com/intent/tweet?via=MikeRyanGough&text=Containerising%20Mule%20Enterprise%20Service%20Bus%20(ESB)%20Community%20Edition&url=https://jimlearning.github.ioarticles/containerising-mule-esb-community-edition">Share on Twitter</a></li><li><a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://jimlearning.github.ioarticles/containerising-mule-esb-community-edition">Share on Facebook</a></li><li><a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&&titleContainerising%20Mule%20Enterprise%20Service%20Bus%20(ESB)%20Community%20Edition=&summary=&source=&url=https://jimlearning.github.ioarticles/containerising-mule-esb-community-edition">Share on LinkedIn</a></li></ul></article></div><footer class="animated fadeIn"><p>Mike Gough Â© 2020.</p><p>Powered by <a href="https://github.com/johnsundell/publish">Publish</a> and hosted on <a href="https://github.com/Mike-Gough/Mike-Gough.github.io">GitHub Pages</a>. 100% JavaScript-free.</p><p>Notice a broken link or other issue? <a href="https://github.com/Mike-Gough/Mike-Gough.github.io/issues">Open an issue!</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></body></html>